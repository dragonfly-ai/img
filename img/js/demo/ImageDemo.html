<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>img.dragonfly.ai Demo</title>
    <script type="text/javascript" src="../target/scala-2.12/img-fastopt.js"></script>
</head>
<body style="background-color: #000000;">
<!-- canvas id="testCanvas01" width="800" height="800" style="position: absolute; top: 400px; left: 400px;"></canvas -->
<script type="text/javascript">
var body = document.getElementsByTagName("body")[0];
/*
var canvas = document.getElementById("testCanvas01");
var ctx = canvas.getContext("2d");
ctx.fillStyle = "black";
ctx.fillRect(0, 0, 800, 800);
*/
var img1 = ai.dragonfly.img.Img(1920, 1080);
img1.randomizeRGB();

var Clr = Color();
var blue = Clr.RGBA(0,0,255).argb;
var red = Clr.RGBA(255,0,0).argb;
img1.pixels(function(x, y){
  if (x % 2 == y % 2) img1.setARGB(x, y, blue);
  else img1.setARGB(x, y, red);
});
var idu = ai.dragonfly.img.ImageDOMUtils();
var canvas = idu.toCanvas(img1);
body.append(canvas);

var img2 = ai.dragonfly.img.Img(50, 50);
img2.randomizeRGB();
body.append(idu.toHtmlImage(img2));

img1.setIntArray(30, 60, 50, 50, img2.getIntArray(0, 0, img2.width, img2.height), 0, 50)
img1.setUint8ClampedArray(130, 60, 50, 50, img2.getUint8ClampedArray(0, 0, img2.width, img2.height))
idu.renderToCanvas(img1, canvas);

console.log(img1.getARGB(1, 2));

function drawImage(){
  var logoImgHtmlElement = document.getElementById("dragonfly.ai-logo");
  console.log(logoImgHtmlElement.naturalWidth + "x" + logoImgHtmlElement.naturalHeight);
  var logoImg = idu.htmlImageElementToImg(logoImgHtmlElement);
  img1.setUint8ClampedArray(230, 60, logoImg.width, logoImg.height, logoImg.getUint8ClampedArray(0, 0, logoImg.width, logoImg.height))
  idu.renderToCanvas(img1, canvas);
  body.append(idu.toHtmlImage(logoImg));
  body.append(idu.toHtmlImage(logoImg.getSubImage(310, 150, 100, 100)));
}

function drawSprite(){
  var spriteImgHtmlElement = document.getElementById("aa");
  console.log(spriteImgHtmlElement.naturalWidth + "x" + spriteImgHtmlElement.naturalHeight);
  var spriteImg = idu.htmlImageElementToImg(spriteImgHtmlElement);
  var cornerColor = Clr.toRgba(spriteImg.getARGB(0, 0));
  console.log(cornerColor.toString());
  img1.setUint8ClampedArray(30, 160, spriteImg.width, spriteImg.height, spriteImg.getUint8ClampedArray(0, 0, spriteImg.width, spriteImg.height))
  img1.overlay(spriteImg, 30, 260, 0, 0, 64, 64);
  idu.renderToCanvas(img1, canvas);
  body.append(idu.toHtmlImage(spriteImg));
}
</script>
<img id="dragonfly.ai-logo" src="./logo.png" style="position: absolute; top:-5000px; left:-5000px" onload="drawImage()" />
<img id="aa" src="./aa.png" style="position: absolute; top:-5000px; left:-5000px" onload="drawSprite()" />
</body>
</html>